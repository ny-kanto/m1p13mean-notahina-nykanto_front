<!-- product-detail-boutique.component.html -->
<div class="product-detail-boutique-container">

  <!-- Header avec actions -->
  <div class="page-header">
    <button class="btn-back" (click)="goBack()">
      <i class="fas fa-arrow-left"></i>
      Retour à mes produits
    </button>
  </div>

  <!-- État de chargement -->
  @if (isLoading) {
    <div class="loading-state">
      <div class="spinner"></div>
      <p>Chargement...</p>
    </div>
  }

  <!-- Message d'erreur -->
  @if (errorMessage && !isLoading) {
    <div class="error-state">
      <div class="error-icon"><i class="fas fa-exclamation-triangle"></i></div>
      <h3>Erreur</h3>
      <p>{{ errorMessage }}</p>
      <button class="btn-retry" (click)="loadProduct()">Réessayer</button>
    </div>
  }

  <!-- Contenu principal -->
  @if (product && !isLoading && !errorMessage) {
    <div class="content-grid">

      <!-- COLONNE GAUCHE : Infos produit -->
      <div class="left-column">

        <!-- Carte : Informations générales -->
        <div class="card">
          <div class="card-header">
            <h2><i class="fas fa-info-circle"></i> Informations du produit</h2>
          </div>
          <div class="card-body">

            <!-- Nom et prix -->
            <div class="info-row">
              <label>Nom du produit</label>
              <p class="value-primary">{{ product.nom }}</p>
            </div>

            <div class="info-row">
              <label>Prix de vente</label>
              <p class="value-price">{{ product.prix }} Ar</p>
            </div>

            <!-- Description -->
            <div class="info-row">
              <label>Description</label>
              @if (product.description) {
                <p class="value-description">{{ product.description }}</p>
              } @else {
                <p class="no-value">Aucune description</p>
              }
            </div>

            <!-- Référence -->
            <div class="info-row">
              <label>Référence</label>
              <p class="value-code">{{ product._id }}</p>
            </div>

          </div>
        </div>

        <!-- Carte : Galerie d'images -->
        <div class="card">
          <div class="card-header">
            <h2><i class="fas fa-images"></i> Galerie d'images</h2>
            <span class="badge-count">{{ product.images.length || 0 }} image(s)</span>
          </div>
          <div class="card-body">

            @if (product.images && product.images.length > 0) {
              <!-- Image principale -->
              <div class="main-image-container">
                <img
                  [src]="product.images[selectedImageIndex]"
                  [alt]="product.nom"
                  class="main-image"
                >
              </div>

              <!-- Miniatures -->
              @if (product.images.length > 1) {
                <div class="thumbnails-grid">
                  @for (image of product.images; track $index) {
                    <div
                      class="thumbnail"
                      [class.active]="selectedImageIndex === $index"
                      (click)="selectImage($index)"
                    >
                      <img [src]="image" [alt]="product.nom">
                    </div>
                  }
                </div>
              }
            } @else {
              <div class="no-images">
                <i class="fas fa-image"></i>
                <p>Aucune image</p>
              </div>
            }

          </div>
        </div>

      </div>

      <!-- COLONNE DROITE : Stock & Statistiques -->
      <div class="right-column">

        <!-- Carte : Gestion du stock -->
        <div class="card card-stock">
          <div class="card-header">
            <h2><i class="fas fa-boxes"></i> Gestion du stock</h2>
          </div>
          <div class="card-body">

          </div>
        </div>

        <!-- Carte : Statistiques -->
        <div class="card card-stats">
          <div class="card-header">
            <h2><i class="fas fa-chart-line"></i> Statistiques</h2>
            <span class="period-badge">Ce mois</span>
          </div>
          <div class="card-body">

            <div class="stats-grid">

              <!-- Ventes -->
              <div class="stat-item">
                <div class="stat-icon sales">
                  <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="stat-info">
                  <span class="stat-value">{{ stats.ventesMois }}</span>
                  <span class="stat-label">Ventes ce mois</span>
                </div>
              </div>

              <!-- Revenus -->
              <div class="stat-item">
                <div class="stat-icon revenue">
                  <i class="fas fa-dollar-sign"></i>
                </div>
                <div class="stat-info">
                  <span class="stat-value">{{ stats.revenusTotal | number }} Ar</span>
                  <span class="stat-label">Revenus générés</span>
                </div>
              </div>

              <!-- Vues -->
              <div class="stat-item">
                <div class="stat-icon views">
                  <i class="fas fa-eye"></i>
                </div>
                <div class="stat-info">
                  <span class="stat-value">{{ stats.vuesTotal }}</span>
                  <span class="stat-label">Vues du produit</span>
                </div>
              </div>

              <!-- Favoris -->
              <div class="stat-item">
                <div class="stat-icon favorites">
                  <i class="fas fa-heart"></i>
                </div>
                <div class="stat-info">
                  <span class="stat-value">{{ stats.favorisTotal }}</span>
                  <span class="stat-label">Ajouts en favoris</span>
                </div>
              </div>

            </div>

          </div>
        </div>

        <!-- Carte : Actions rapides -->
        <div class="card card-actions">
          <div class="card-header">
            <h2><i class="fas fa-bolt"></i> Actions rapides</h2>
          </div>
          <div class="card-body">

            <button class="action-link">
              <i class="fas fa-tags"></i>
              <span>Créer une promotion</span>
              <i class="fas fa-chevron-right"></i>
            </button>

            <button class="action-link">
              <i class="fas fa-clone"></i>
              <span>Dupliquer ce produit</span>
              <i class="fas fa-chevron-right"></i>
            </button>

            <button class="action-link">
              <i class="fas fa-chart-bar"></i>
              <span>Voir les statistiques détaillées</span>
              <i class="fas fa-chevron-right"></i>
            </button>

            <button class="action-link">
              <i class="fas fa-history"></i>
              <span>Historique des modifications</span>
              <i class="fas fa-chevron-right"></i>
            </button>

          </div>
        </div>

      </div>

    </div>
  }

</div>

